<!DOCTYPE html>
<html>
<head>
	<title>Twitch Stats | Home</title>
	<link rel="stylesheet" type="text/css" href="/styles/style.css">
</style>
<script src="/socket.io/socket.io.js"></script>
<script src="/js/jquery.min.js"></script>
<script>
	// Create Socket.IO object
	var socket = io();

	// Declare how many words are supposed to show up in the common words table
	var maxWords = 10;

	// Declare how long common words are supposed to be stored (in ms)
	var maxWordAge = 60000;

	// Set the update time for the table (in ms)
	var updateTime = 1000;

	// Create array to temporarily store words from chat messages
	var recentWords = [];
</script>
</head>
<body>
	<nav>
		<div class="center container">
			<h1 id="logo">Twitch Stats</h1>
			<div class="subtitle">Chat Statistics and Visualisations</div>
		</div>
	</nav>
	<main>
		<div class="center container">
			<form id="channel-picker" action="">
				<input id="channel" placeholder="Enter a channel name...">
				<button>Pick</button>
				<div id="status">Connected</div>
			</form>
		</div>
		<div id="keyword" class="container">
			<div id="keyword-picker" class="center">
				<span>Keyword: </span><input id="keyword" onchange="resetCounter()" placeholder="Type something...">
			</div>
			<div id="word-counter" class="center">
				<h2>Counter</h2>
				<p id="count">0</p>
				<span id="count-unit">words</span><br>
				<button id="count-reset" type="button" onclick="resetCounter()">Reset</button>
			</div>
			<div id="word-freq" class="center">
				<h2>Frequency</h2>
				<p id="freq">0</p>
				<span id="freq-unit">words/sec</span>
			</div>
		</div>
		<div id="common-words" class="center container">
			<h2>Common words</h2>
			<p>The most used words in the past 60 seconds<p>
			<table id="common-words-table" class="center">
				<thead>
					<tr><th>Word</th><th>Count</th></tr>
				</thead>
				<tbody>
				</tbody>
			</table>
		</div>
	</main>
	<script src="/js/wordcounter.js"></script>
	<script>
		// Load the emotes list
		var emotes;
		$.getJSON('/emotes.json', function(json){
			emotes = json.emotes;
		});

		// Gets emote data from json file by name
		function getEmoteByName(name){
			return emotes.filter(
				function(emotes){ return emotes.name == name }
			);
		}

		// Ask server to change channel when submit button is clicked
		$('#channel-picker').submit(function(){
			resetCounter();
			socket.emit('channelChange', $('#channel').val());
			return false; // Avoids reloading the page
		});

		// Provide feeback when we connect to the channel
		socket.on('channelChangeSuccess', function(){
			$('#status').html('Connected');
			$('#status').css('opacity', '1');
			$('#status').animate({ opacity: 0 }, 1500);
		});
	</script>
</body>
</html>
